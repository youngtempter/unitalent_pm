<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>UniTalent ‚Äì Student Career Platform</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          }
        }
      }
    }
  </script>

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Abstract background -->
  <style>
    body {
      position: relative;
      overflow-x: hidden;
      background: #020617;
    }

    .animated-bg {
      position: fixed;
      inset: 0;
      z-index: -10;
      pointer-events: none;
      background: radial-gradient(circle at top, #020617 0, #020617 40%, #000 100%);
      overflow: hidden;
    }

    .animated-bg::before {
      content: "";
      position: absolute;
      left: -50%;
      bottom: -40%;
      width: 200%;
      height: 200%;
      background-image: radial-gradient(#64748b 1px, transparent 1px);
      background-size: 26px 26px;
      opacity: 0.5;
      transform-origin: center;
      transform: perspective(900px) rotateX(72deg) translateY(0);
      animation: moveGrid 18s linear infinite;
    }

    @keyframes moveGrid {
      0% {
        transform: perspective(900px) rotateX(72deg) translateY(0);
      }

      100% {
        transform: perspective(900px) rotateX(72deg) translateY(140px);
      }
    }

    .orb {
      position: absolute;
      border-radius: 9999px;
      filter: blur(40px);
      opacity: 0.7;
    }
  </style>
</head>

<body class="font-sans text-slate-100">
  <!-- Animated background -->
  <div class="animated-bg">
    <div class="orb -top-20 -left-10 h-64 w-64 bg-indigo-600/40"></div>
    <div class="orb top-40 -right-10 h-72 w-72 bg-emerald-500/35"></div>
    <div class="orb bottom-0 left-1/2 h-52 w-52 -translate-x-1/2 bg-fuchsia-500/25"></div>
  </div>

  <!-- NAVBAR -->
  <header class="sticky top-0 z-20 border-b border-slate-800/60 bg-slate-950/80 backdrop-blur">
    <nav class="mx-auto flex max-w-6xl items-center justify-between px-4 py-3 md:py-4">
      <!-- Logo -->
      <a href="index.html" class="flex items-center gap-2">
        <div
          class="flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-900/70 shadow-lg shadow-indigo-500/40">
          <img src="assets/logo.png" alt="UniTalent logo" class="h-8 w-8 object-contain" />
        </div>
        <div class="leading-tight">
          <p class="text-base font-semibold tracking-tight">UniTalent</p>
          <p class="text-[11px] text-slate-400">Student Career Platform</p>
        </div>
      </a>

      <!-- Desktop menu -->
      <div class="hidden items-center gap-6 text-sm font-medium text-slate-200 md:flex">
        <a href="#how" class="hover:text-indigo-300">How it works</a>
        <a href="jobs.html" class="hover:text-indigo-300">Jobs</a>
        <a href="student-login.html" class="hover:text-indigo-300">For students</a>
        <a href="employer-login.html" class="hover:text-indigo-300">For employers</a>
        <a href="#about" class="hover:text-indigo-300">About</a>
      </div>

      <!-- Auth buttons (dynamic) -->
      <div id="authArea" class="hidden items-center gap-3 md:flex">
        <!-- Guest -->
        <a id="loginBtn" href="student-login.html" class="text-sm font-medium text-slate-200 hover:text-indigo-300">
          Log in
        </a>
        <a id="signupBtn" href="student-signup.html"
          class="rounded-full bg-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-indigo-500/40 hover:bg-indigo-400">
          Sign up
        </a>

        <!-- Authed -->
        <a id="dashboardBtn" href="#"
          class="hidden rounded-full bg-slate-950/70 px-4 py-2 text-sm font-semibold text-slate-50 ring-1 ring-slate-700 hover:bg-slate-900 hover:ring-indigo-400">
          Dashboard
        </a>
        <button id="logoutBtn"
          class="hidden rounded-full border border-slate-700 bg-slate-950/60 px-4 py-2 text-sm font-semibold text-slate-200 hover:border-rose-400 hover:text-rose-200">
          Log out
        </button>
      </div>

      <!-- Mobile menu button (visual) -->
      <button
        class="inline-flex items-center justify-center rounded-full border border-slate-700 p-2 text-slate-200 md:hidden">
        <span class="sr-only">Open menu</span>
        <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </nav>
  </header>

  <main class="mx-auto max-w-6xl px-4 pb-16 pt-8 md:pt-12">
    <!-- HERO -->
    <section id="hero" class="grid gap-10 py-6 md:grid-cols-2 md:items-center md:py-12">
      <!-- Left -->
      <div class="space-y-6">
        <div
          class="inline-flex items-center gap-2 rounded-full border border-indigo-500/40 bg-indigo-500/10 px-3 py-1 text-[11px] font-medium text-indigo-200">
          <span class="inline-flex h-2 w-2 rounded-full bg-emerald-400"></span>
          Platform for university talents
        </div>

        <div class="space-y-3">
          <h1 class="text-3xl font-extrabold tracking-tight text-slate-50 sm:text-4xl lg:text-5xl">
            Find your first <span class="text-indigo-300">real job</span> while you study.
          </h1>
          <p class="max-w-xl text-sm text-slate-300 md:text-base">
            UniTalent connects students and fresh graduates with internships and junior roles
            from companies that actually look for young talent.
          </p>
        </div>

        <div class="flex flex-wrap items-center gap-3">
          <a id="heroStudentBtn" href="student-login.html"
            class="inline-flex items-center justify-center rounded-full bg-indigo-500 px-5 py-2.5 text-sm font-semibold text-white shadow-lg shadow-indigo-500/40 hover:bg-indigo-400">
            Get started as student
          </a>

          <a id="heroEmployerBtn" href="employer-login.html"
            class="js-post-job-cta inline-flex items-center justify-center rounded-full border border-slate-600 bg-slate-950/70 px-5 py-2.5 text-sm font-semibold text-slate-100 hover:border-indigo-400 hover:text-indigo-200">
            Post a role as employer
          </a>
        </div>

        <div class="flex flex-wrap items-center gap-6 pt-2 text-xs text-slate-400 md:text-sm">
          <div>
            <p class="font-semibold text-slate-100">500+ students</p>
            <p>already exploring roles</p>
          </div>
          <div>
            <p class="font-semibold text-slate-100">100+ companies</p>
            <p>interested in junior talent</p>
          </div>
        </div>
      </div>

      <!-- Right -->
      <div class="relative">
        <div class="absolute -top-10 -right-6 h-28 w-28 rounded-full bg-indigo-500/40 blur-3xl"></div>
        <div
          class="relative rounded-3xl border border-slate-800/80 bg-slate-900/80 p-4 shadow-2xl shadow-slate-950/80 backdrop-blur">
          <div class="overflow-hidden rounded-2xl border border-slate-800/80">
            <img
              src="https://people.com/thmb/RpnNLplOGndVrTF-rdBlp0biuxE=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc():focal(719x39:721x41)/Emma-Watson-c59dff78899047bb839b894665b85a13.jpg"
              alt="Students collaborating on laptops" class="h-48 w-full object-cover md:h-56" />
          </div>

          <div class="mt-4 grid gap-4 md:grid-cols-2">
            <div class="rounded-2xl border border-slate-800 bg-slate-950/80 p-3">
              <div class="flex items-center gap-3">
                <div
                  class="flex h-9 w-9 items-center justify-center rounded-full bg-indigo-500 text-sm font-semibold text-white">
                  AY
                </div>
                <div class="text-xs">
                  <p class="font-semibold text-slate-100">Aruzhan Y.</p>
                  <p class="text-slate-400">2nd year ¬∑ CS</p>
                </div>
              </div>
              <div class="mt-3 flex flex-wrap gap-2">
                <span class="rounded-full bg-slate-800 px-2 py-1 text-[11px] text-slate-100">Frontend</span>
                <span class="rounded-full bg-slate-800 px-2 py-1 text-[11px] text-slate-100">React</span>
                <span class="rounded-full bg-slate-800 px-2 py-1 text-[11px] text-slate-100">Internship ready</span>
              </div>
            </div>

            <div class="rounded-2xl border border-slate-800 bg-slate-950/80 p-3">
              <div class="flex items-start justify-between gap-2">
                <div class="text-xs">
                  <p class="text-[11px] uppercase tracking-wide text-emerald-400">New internship</p>
                  <p class="mt-1 text-sm font-semibold text-slate-50">Junior Frontend Developer</p>
                  <p class="text-xs text-slate-400">Almaty ¬∑ Hybrid</p>
                </div>
                <span class="rounded-full bg-emerald-500/15 px-2 py-1 text-[11px] font-medium text-emerald-300">
                  Internship
                </span>
              </div>
              <p class="mt-2 line-clamp-2 text-xs text-slate-300">
                Build real features, learn modern web tools and work with a mentor.
              </p>
              <a href="jobs.html"
                class="mt-3 block w-full rounded-full bg-indigo-500 px-3 py-1.5 text-center text-xs font-semibold text-white hover:bg-indigo-400">
                View details
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- HOW IT WORKS -->
    <section id="how" class="mt-16 space-y-8">
      <div class="text-center">
        <h2 class="text-2xl font-bold tracking-tight text-slate-50 md:text-3xl">
          How UniTalent works
        </h2>
        <p class="mt-2 text-sm text-slate-400 md:text-base">
          Three simple steps from profile to your first offer.
        </p>
      </div>

      <div class="grid gap-6 md:grid-cols-3">
        <div class="rounded-2xl border border-slate-800 bg-slate-900/80 p-5 shadow-lg shadow-slate-950/60">
          <div class="mb-4 inline-flex h-10 w-10 items-center justify-center rounded-2xl bg-indigo-500/20">
            <span class="text-lg">üìÑ</span>
          </div>
          <h3 class="text-sm font-semibold text-slate-50">Create a profile</h3>
          <p class="mt-2 text-sm text-slate-400">
            Add your degree, skills and projects in a clean student-friendly format.
          </p>
        </div>

        <div class="rounded-2xl border border-slate-800 bg-slate-900/80 p-5 shadow-lg shadow-slate-950/60">
          <div class="mb-4 inline-flex h-10 w-10 items-center justify-center rounded-2xl bg-emerald-500/15">
            <span class="text-lg">üîç</span>
          </div>
          <h3 class="text-sm font-semibold text-slate-50">Browse roles</h3>
          <p class="mt-2 text-sm text-slate-400">
            Filter internships and junior positions by city, field and work mode.
          </p>
        </div>

        <div class="rounded-2xl border border-slate-800 bg-slate-900/80 p-5 shadow-lg shadow-slate-950/60">
          <div class="mb-4 inline-flex h-10 w-10 items-center justify-center rounded-2xl bg-indigo-500/20">
            <span class="text-lg">‚úÖ</span>
          </div>
          <h3 class="text-sm font-semibold text-slate-50">Apply & track</h3>
          <p class="mt-2 text-sm text-slate-400">
            Send applications in one click and track responses on a simple dashboard.
          </p>
        </div>
      </div>
    </section>

    <!-- FEATURED JOBS -->
    <section id="jobs-section" class="mt-16 space-y-8">
      <div class="flex flex-col items-start justify-between gap-3 md:flex-row md:items-end">
        <div>
          <h2 class="text-2xl font-bold tracking-tight text-slate-50 md:text-3xl">
            Sample opportunities
          </h2>
          <p class="mt-2 text-sm text-slate-400 md:text-base">
            Latest roles posted by real employers on UniTalent.
          </p>
          <p id="featuredStatus" class="mt-2 text-xs text-slate-500">
            Loading featured jobs...
          </p>
        </div>
        <a href="jobs.html" class="text-xs font-semibold text-indigo-300 hover:text-indigo-200">
          View all jobs ‚Üí
        </a>
      </div>

      <div id="featuredJobsList" class="grid gap-5 md:grid-cols-3"></div>
    </section>

    <!-- STUDENTS / EMPLOYERS SPLIT -->
    <section class="mt-16 grid gap-6 md:grid-cols-2">
      <div class="flex flex-col rounded-3xl border border-slate-800 bg-slate-900/80 p-6 shadow-xl shadow-slate-950/60">
        <h2 class="text-lg font-semibold text-slate-50">For students</h2>
        <p class="mt-2 text-sm text-slate-300">One profile, many opportunities.</p>
        <ul class="mt-4 space-y-2 text-sm text-slate-200">
          <li>‚Ä¢ Show your studies, skills and projects.</li>
          <li>‚Ä¢ Save interesting roles and track status.</li>
          <li>‚Ä¢ Get suggestions that match your major.</li>
        </ul>
        <a href="student-login.html"
          class="mt-5 w-fit rounded-full bg-slate-950/80 px-4 py-2 text-xs font-semibold text-slate-50 ring-1 ring-slate-700 hover:bg-slate-900 hover:ring-indigo-400">
          Explore student experience
        </a>
      </div>

      <div class="flex flex-col rounded-3xl border border-slate-800 bg-slate-900/80 p-6 shadow-xl shadow-slate-950/60">
        <h2 class="text-lg font-semibold text-slate-50">For employers</h2>
        <p class="mt-2 text-sm text-slate-300">Focused access to early-career talent.</p>
        <ul class="mt-4 space-y-2 text-sm text-slate-200">
          <li>‚Ä¢ Post internships and junior roles in minutes.</li>
          <li>‚Ä¢ Filter by skills, major and graduation year.</li>
          <li>‚Ä¢ Manage applications in one dashboard.</li>
        </ul>

        <a href="employer-login.html"
          class="js-post-job-cta mt-5 w-fit rounded-full bg-indigo-500 px-4 py-2 text-xs font-semibold text-white shadow-md shadow-indigo-500/40 hover:bg-indigo-400">
          Post a job
        </a>
      </div>
    </section>

    <!-- TESTIMONIAL -->
    <section class="mt-16 rounded-3xl border border-slate-800 bg-slate-900/80 p-6 shadow-xl shadow-slate-950/60">
      <div class="grid gap-6 md:grid-cols-[1.2fr,1fr] md:items-center">
        <div>
          <p class="text-xs font-semibold uppercase tracking-wide text-emerald-400">
            Student story
          </p>
          <h2 class="mt-2 text-xl font-bold text-slate-50 md:text-2xl">
            ‚ÄúI found my first internship before graduation.‚Äù
          </h2>
          <p class="mt-3 text-sm text-slate-300">
            ‚ÄúUniTalent helped me structure my profile and focus on roles that fit my skills.
            After a few applications, I had two interviews and one offer.‚Äù
          </p>
          <p class="mt-4 text-sm font-semibold text-slate-100">
            Aigerim ¬∑ SDU ¬∑ Information Systems
          </p>
        </div>
        <div class="space-y-3 rounded-2xl border border-slate-800 bg-slate-950/70 p-4 text-xs text-slate-300">
          <p>Why students use UniTalent:</p>
          <ul class="mt-2 space-y-1">
            <li>‚Ä¢ Focus on internships and junior roles.</li>
            <li>‚Ä¢ Clear UI made for students, not seniors.</li>
            <li>‚Ä¢ All applications and offers in one place.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- ABOUT & CONTACT -->
    <section id="about" class="mt-16 grid gap-8 md:grid-cols-[1.3fr,1fr]">
      <div class="space-y-4">
        <h2 class="text-2xl font-bold tracking-tight text-slate-50 md:text-3xl">
          Built by students, for students.
        </h2>
        <p class="text-sm text-slate-300">
          UniTalent started as a university project to make it easier to find real experience
          before graduation. We focus on clear UX, relevant roles and simple communication.
        </p>
        <div class="grid gap-4 text-sm text-slate-200 md:grid-cols-2">
          <div class="rounded-2xl border border-slate-800 bg-slate-900/80 p-4">
            <p class="text-xs font-semibold text-slate-400">Our mission</p>
            <p class="mt-1">
              Give every student a fair chance to show their skills and get a first step in their career.
            </p>
          </div>
          <div class="rounded-2xl border border-slate-800 bg-slate-900/80 p-4">
            <p class="text-xs font-semibold text-slate-400">Our focus</p>
            <p class="mt-1">
              Universities, internships and junior positions that match what students actually study.
            </p>
          </div>
        </div>
      </div>

      <div id="contact" class="rounded-3xl border border-slate-800 bg-slate-900/80 p-5 shadow-xl shadow-slate-950/60">
        <h3 class="text-sm font-semibold text-slate-50">Contact us</h3>
        <p class="mt-1 text-xs text-slate-400">
          Have questions or want to partner with UniTalent? Send us a quick message.
        </p>
        <form class="mt-3 space-y-3 text-xs">
          <div>
            <label class="mb-1 block text-slate-300">Name</label>
            <input type="text"
              class="w-full rounded-2xl border border-slate-700 bg-slate-950/60 px-3 py-2 text-xs text-slate-100 placeholder:text-slate-500 focus:border-indigo-500 focus:outline-none"
              placeholder="Your name" />
          </div>
          <div>
            <label class="mb-1 block text-slate-300">Email</label>
            <input type="email"
              class="w-full rounded-2xl border border-slate-700 bg-slate-950/60 px-3 py-2 text-xs text-slate-100 placeholder:text-slate-500 focus:border-indigo-500 focus:outline-none"
              placeholder="you@example.com" />
          </div>
          <div>
            <label class="mb-1 block text-slate-300">Message</label>
            <textarea rows="3"
              class="w-full rounded-2xl border border-slate-700 bg-slate-950/60 px-3 py-2 text-xs text-slate-100 placeholder:text-slate-500 focus:border-indigo-500 focus:outline-none"
              placeholder="Tell us how we can help..."></textarea>
          </div>
          <button type="button"
            class="w-full rounded-full bg-indigo-500 px-3 py-2 text-xs font-semibold text-white hover:bg-indigo-400">
            Send message
          </button>
        </form>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="border-t border-slate-800 bg-slate-950/90">
    <div
      class="mx-auto flex max-w-6xl flex-col gap-3 px-4 py-5 text-xs text-slate-500 md:flex-row md:items-center md:justify-between">
      <p>¬© 2025 UniTalent. All rights reserved.</p>
      <div class="flex flex-wrap gap-4">
        <a href="#about" class="hover:text-indigo-300">About</a>
        <a href="#contact" class="hover:text-indigo-300">Contact</a>
        <span>Terms ¬∑ Privacy</span>
      </div>
    </div>
  </footer>

  <!-- ‚úÖ JS (UPDATED) -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const API = 'http://localhost:3000';

      // -------------------------
      // ‚úÖ Pair-safe auth (no mixing local/session)
      // -------------------------
      function readAuthPair(storage) {
        const token = storage.getItem('unitalent_token');
        const userRaw = storage.getItem('unitalent_user');
        if (!token || !userRaw) return null;

        try {
          return { token, user: JSON.parse(userRaw), storage };
        } catch {
          storage.removeItem('unitalent_token');
          storage.removeItem('unitalent_user');
          return null;
        }
      }

      function readUniTalentAuth() {
        return (
          readAuthPair(localStorage) ||
          readAuthPair(sessionStorage) ||
          { token: null, user: null, storage: null }
        );
      }

      function clearAllAuth() {
        ['unitalent_token', 'unitalent_user'].forEach(k => {
          localStorage.removeItem(k);
          sessionStorage.removeItem(k);
        });

        [
          'unitalent_student_name',
          'unitalent_student_email',
          'unitalent_student_username',
          'unitalent_employer_name',
          'unitalent_employer_bin',
          'unitalent_employer_city',
          'unitalent_employer_size'
        ].forEach(k => {
          localStorage.removeItem(k);
          sessionStorage.removeItem(k);
        });
      }

      // -------------------------
      // DOM refs
      // -------------------------
      const authArea = document.getElementById('authArea');
      const loginBtn = document.getElementById('loginBtn');
      const signupBtn = document.getElementById('signupBtn');
      const dashboardBtn = document.getElementById('dashboardBtn');
      const logoutBtn = document.getElementById('logoutBtn');

      const heroStudentBtn = document.getElementById('heroStudentBtn');
      const heroEmployerBtn = document.getElementById('heroEmployerBtn');

      const featuredList = document.getElementById('featuredJobsList');
      const featuredStatus = document.getElementById('featuredStatus');

      // -------------------------
      // UI helpers
      // -------------------------
      function escapeHtml(str = '') {
        return String(str)
          .replaceAll('&', '&amp;')
          .replaceAll('<', '&lt;')
          .replaceAll('>', '&gt;')
          .replaceAll('"', '&quot;')
          .replaceAll("'", '&#039;');
      }

      function truncate(text = '', n = 120) {
        const t = String(text);
        return t.length > n ? t.slice(0, n).trim() + '‚Ä¶' : t;
      }

      function employerDisplay(job) {
        const fn = job.employer?.firstName;
        const ln = job.employer?.lastName;
        const full = [fn, ln].filter(Boolean).join(' ');
        return full || job.employer?.email || 'Company';
      }

      function formatDate(iso) {
        try {
          const d = new Date(iso);
          if (Number.isNaN(d.getTime())) return null;
          return d.toLocaleDateString();
        } catch {
          return null;
        }
      }

      function setFeaturedStatus(ok, text) {
        if (!featuredStatus) return;
        featuredStatus.className = `mt-2 text-xs ${ok ? 'text-slate-500' : 'text-rose-300'}`;
        featuredStatus.textContent = text;
      }

      // Show auth area once JS runs
      authArea?.classList.remove('hidden');

      // -------------------------
      // Navbar auth UI
      // -------------------------
      function setGuestUI() {
        loginBtn?.classList.remove('hidden');
        signupBtn?.classList.remove('hidden');
        dashboardBtn?.classList.add('hidden');
        logoutBtn?.classList.add('hidden');

        if (heroStudentBtn) heroStudentBtn.href = 'student-login.html';
        if (heroEmployerBtn) heroEmployerBtn.href = 'employer-login.html';
      }

      function setAuthedUI(user) {
        loginBtn?.classList.add('hidden');
        signupBtn?.classList.add('hidden');
        dashboardBtn?.classList.remove('hidden');
        logoutBtn?.classList.remove('hidden');

        const isEmployer = user?.role === 'EMPLOYER';

        if (dashboardBtn) {
          dashboardBtn.href = isEmployer
            ? 'employer-dashboard.html'
            : 'student-dashboard.html';
        }

        // CTA smart targets
        if (heroStudentBtn) {
          heroStudentBtn.href = isEmployer
            ? 'student-login.html'
            : 'student-dashboard.html';
        }

        if (heroEmployerBtn) {
          heroEmployerBtn.href = isEmployer
            ? 'employer-new-job.html'
            : 'employer-login.html';
        }
      }

      const { token, user } = readUniTalentAuth();
      if (token && user) setAuthedUI(user);
      else setGuestUI();

      logoutBtn?.addEventListener('click', (e) => {
        e.preventDefault();
        clearAllAuth();
        window.location.href = 'index.html';
      });

      // -------------------------
      // ‚úÖ Employer "Post a job" CTA fix
      // -------------------------
      function handlePostJobClick(e) {
        const { token: t, user: u } = readUniTalentAuth();

        if (!t || !u) return; // not logged in -> default link

        if (u.role === 'EMPLOYER') {
          e.preventDefault();
          window.location.href = 'employer-new-job.html';
          return;
        }

        if (u.role === 'STUDENT') {
          e.preventDefault();
          alert('You are logged in as STUDENT. Please log in with an EMPLOYER account to post jobs.');
        }
      }

      document.querySelectorAll('.js-post-job-cta').forEach(btn => {
        btn.addEventListener('click', handlePostJobClick);
      });

      // -------------------------
      // Featured jobs render
      // -------------------------
      function renderFeatured(jobs = []) {
        if (!featuredList) return;

        if (!jobs.length) {
          featuredList.innerHTML = `
            <div class="md:col-span-3 rounded-2xl border border-slate-800 bg-slate-900/80 p-5 text-sm text-slate-300">
              No jobs yet. First employer posts will appear here.
            </div>
          `;
          return;
        }

        featuredList.innerHTML = jobs.map(job => {
          const title = escapeHtml(job.title || 'Untitled role');
          const location = escapeHtml(job.location || 'Location not specified');
          const salary = escapeHtml(job.salary || 'Salary not specified');
          const company = escapeHtml(employerDisplay(job));
          const desc = escapeHtml(truncate(job.description || ''));

          const posted = formatDate(job.createdAt);
          const postedText = posted ? `Posted on ${posted}` : 'Posted recently';

          return `
            <article class="flex flex-col rounded-2xl border border-slate-800 bg-slate-900/80 p-4 shadow-lg shadow-slate-950/60">
              <header class="flex items-start justify-between gap-2">
                <div>
                  <p class="text-xs uppercase tracking-wide text-emerald-400">Newest role</p>
                  <h3 class="mt-1 text-sm font-semibold text-slate-50">${title}</h3>
                  <p class="text-xs text-slate-400">${company} ¬∑ ${location}</p>
                  <p class="mt-1 text-[11px] text-slate-500">${salary}</p>
                </div>
                <span class="rounded-full bg-emerald-500/15 px-2 py-1 text-[11px] font-medium text-emerald-300">
                  Open
                </span>
              </header>

              <p class="mt-3 line-clamp-3 text-xs text-slate-300">
                ${desc || 'Role description will be updated soon.'}
              </p>

              <footer class="mt-4 flex items-center justify-between text-xs text-slate-500">
                <span>${postedText}</span>
                <div class="flex items-center gap-2">
                  <a href="student-login.html"
                    class="js-featured-apply rounded-full bg-indigo-500 px-3 py-1 text-[11px] font-semibold text-white hover:bg-indigo-400"
                    data-job-id="${job.id}">
                    Apply now
                  </a>
                  <a href="jobs.html"
                    class="rounded-full border border-slate-700 bg-slate-950/60 px-3 py-1 text-[11px] font-semibold text-slate-200 hover:border-indigo-400 hover:text-indigo-200">
                    Details
                  </a>
                </div>
              </footer>
            </article>
          `;
        }).join('');
      }

      async function loadFeaturedJobs() {
        try {
          setFeaturedStatus(true, 'Loading featured jobs...');

          const res = await fetch(`${API}/api/jobs`);
          const data = await res.json().catch(() => ([]));

          if (!res.ok) throw new Error(data?.message || 'Failed to load jobs');

          const jobs = Array.isArray(data) ? data.slice(0, 3) : [];
          renderFeatured(jobs);

          setFeaturedStatus(true, jobs.length
            ? `Showing latest ${jobs.length} real jobs`
            : 'No jobs posted yet');
        } catch (err) {
          console.error(err);
          renderFeatured([]);
          setFeaturedStatus(false, 'Backend not available right now');
        }
      }

      // -------------------------
      // ‚úÖ Apply handler for featured cards
      // -------------------------
      if (featuredList) {
        featuredList.addEventListener('click', async (e) => {
          const btn = e.target.closest('.js-featured-apply');
          if (!btn) return;

          const { token: t, user: u } = readUniTalentAuth();

          if (!t) {
            // not logged in -> allow default href to student-login.html
            return;
          }

          if (u?.role && u.role !== 'STUDENT') {
            e.preventDefault();
            setFeaturedStatus(false, 'Only STUDENT accounts can apply.');
            return;
          }

          e.preventDefault();

          const jobId = Number(btn.dataset.jobId);
          if (!jobId) return;

          const originalText = btn.textContent;

          try {
            btn.textContent = 'Applying...';
            btn.classList.add('opacity-70', 'pointer-events-none');

            const res = await fetch(`${API}/api/applications`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + t
              },
              body: JSON.stringify({ jobId })
            });

            // ‚úÖ handle expired token cleanly
            if (res.status === 401) {
              clearAllAuth();
              window.location.href = 'student-login.html';
              return;
            }

            const data = await res.json().catch(() => ({}));

            if (!res.ok) {
              const msg =
                data?.message ||
                (res.status === 403 ? 'Forbidden.' : 'Failed to apply.');
              throw new Error(msg);
            }

            btn.textContent = 'Applied';
            btn.classList.remove('bg-indigo-500', 'hover:bg-indigo-400');
            btn.classList.add('bg-emerald-500');
            setFeaturedStatus(true, 'Application sent successfully ‚úÖ');
          } catch (err) {
            console.error(err);
            btn.textContent = originalText;
            btn.classList.remove('opacity-70', 'pointer-events-none');
            setFeaturedStatus(false, err.message);
          }
        });
      }

      loadFeaturedJobs();
    });
  </script>
  <script type="module" src="js/auth.js"></script>

</body>

</html>